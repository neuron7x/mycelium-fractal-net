
# ARCHITECTURE — MyceliumFractalNet v4.1

## 1. Рівняння Нернста

Мембранний потенціал для іона з валентністю z:

\[
E = \frac{R T}{z F} \ln\left(\frac{[ion]_\text{out}}{[ion]_\text{in}}\right)
\]

У коді це реалізовано у `compute_nernst_potential`, а також додатково перевірено через
sympy у `_symbolic_nernst_example`.

## 2. Дифузійна решітка ("міцелій")

`simulate_mycelium_field` реалізує:

- 2D-поле потенціалів V(x, y);
- локальні "спайки" (події росту), які піднімають потенціал у випадкових точках;
- дискретний лапласіан (up + down + left + right - 4 * center);
- крок дифузії з коефіцієнтом `alpha`;
- обмеження значень у діапазоні ≈ [-95, 40] мВ.

Це дає стабільну, контрольовану, але все ще "живу" картину поля.

## 3. Фрактальний аналіз

`estimate_fractal_dimension`:
- працює з бінарним полем (активації вище порогу — "міцелій");
- застосовує box-counting підхід для кількох масштабів;
- оцінює нахил лінії у log-log просторі як фрактальну розмірність.

## 4. MyceliumFractalNet (NN-рівень)

`MyceliumFractalNet` — невелика MLP-модель, яка приймає 4-канальний вектор:

1. фрактальна розмірність поля;
2. середній потенціал;
3. стандартне відхилення;
4. максимум потенціалу.

Модель має 2 приховані шари, ReLU-активації, оптимізується Adam з MSE loss.

## 5. Валідаційний цикл

`run_validation`:

1. Генерує датасет з декількох полів.
2. Обчислює статистики + таргетну змінну.
3. Тренує MyceliumFractalNet протягом N епох.
4. Повертає словник метрик (`loss_start`, `loss_final`, `pot_min_mV`, ...).

`run_validation_cli` забезпечує CLI-рівень для запуску системи з терміналу.
