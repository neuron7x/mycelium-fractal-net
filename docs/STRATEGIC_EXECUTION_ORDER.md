# Стратегічний план виконання — Оперативний контроль

Цей документ фіксує виконання вимог «незалежного стратегічно-виконавчого наказу» та прив’язує їх до наявних артефактів репозиторію. Мета — забезпечити контрольовану інтеграцію, безпечні конфіги та відтворюване тестове середовище.

**English summary:** This note maps the strategic execution order to existing controls (CI gates, security defaults, deterministic tests, iteration close-out checklist) so any contributor can follow the same operational playbook.

## 1. Реєстр, блокери, відповідальні
- Джерело реєстру: `planning/mfn_backlog.yaml` (P0/P1/P2), доповнення — `docs/MFN_CONSOLIDATION_REPORT.md` (аудит, покриття) — обидва файли входять до репозиторію.
- Блокери: не виявлено під час базового прогона `pytest -q` (див. контроль нижче).
- Призначення DRI: для кожного PR вказувати відповідального у описі та чеклісті контрольного звіту (шаблон у розділі 5).

## 2. Ворота якості (жодної інтеграції без зеленого CI)
- Обов’язкові джоби: `dependency-review`, `lint`, `test` (матриця Python 3.10–3.12), `security` (bandit + pip-audit + `tests/security`), `validate`, `benchmark`, `scientific-validation`, `scalability-test`, `packaging` — перелік взято з `.github/workflows/ci.yml` (оновити список, якщо пайплайн зміниться).
- Рекомендація: увімкнути захист гілки для `main/develop` із вимогою зеленого `CI` статусу перед merge.
- Покриття критичних шляхів: `pytest --cov=mycelium_fractal_net --cov-report=xml` (job `test`, публікація в Codecov).
- Використовувати `fail-fast: false` у матриці тестів для повної видимості регресій.

## 3. Безпека та конфіги (принцип найменших привілеїв)
- Аутентифікація: у `staging/prod` ключ обов’язковий (`MFN_API_KEY_REQUIRED=true`), ключі читаються через `SecretManager` (env або файли), без hardcode в коді.
- Rate limiting: за замовчуванням увімкнений поза `dev` (`MFN_RATE_LIMIT_ENABLED`), з лімітами на ендпоінт (див. `RateLimitConfig.from_env` у `src/mycelium_fractal_net/integration/api_config.py`).
- Метрики/логування: `/metrics` + структуровані логи з `X-Request-ID`; формат JSON у prod.
- Секрети: зберігаються поза репозиторієм; у PR заборонені тимчасові обхідні маневри (відключення перевірок, коміти секретів).

## 4. Тестове середовище та відтворюваність
- Детермінізм: `tests/test_determinism.py` та `tests/test_validation_cycle.py` фіксують стабільні сид/часові параметри.
- Ізоляція: фікстури не торкаються мережі/ФС поза тимчасовими шляхами.
- Команди для локального контролю:
  - `pip install -e ".[dev]" && pytest -q`
  - Цільові прогін: `pytest tests/security/ -v`, `pytest tests/perf/test_stress_scalability.py -v --tb=short`

## 5. Шаблон контрольного звіту ітерації
- [ ] Опис змін (що, навіщо)
- [ ] Виконані тести/лінти (перелік + командний лог)
- [ ] Статус CI (посилання на зелену збірку)
- [ ] Результати SAST/secret-scan (bandit, pip-audit)
- [ ] Вплив на критичні контури (валидація, доступи, помилки, інтеграції, збереження даних)
- [ ] План відкату (команда/крок)
- [ ] Відповідальний (DRI) і перевірив (reviewer)

## 6. Швидка відповідь на інцидент / ризики
- Якщо CI червоний — зупинити merge, створити пункт у реєстрі (P0/P1) та призначити DRI.
- Заборонено прямі пуші в `main`: усі зміни тільки через PR із заповненим шаблоном контрольного звіту.
- При зміні конфігів прод/стейдж — додати превентивний rollback-план і вказати вплив на секрети/ліміти.
